{{> partial/homeMetaData}}
<div class="section-container">
    {{> partial/searchAndFilter}}

    {{#if posts.length}}
    <div class="posts-grid" id="postsGrid">
        {{#each posts}}
        <article class="post-card" data-post-id="{{this.id}}" data-author="{{this.UserName}}" data-categories="{{this.categories}}" data-created-at="{{this.created_at}}" data-comment-count="{{this.comment_count}}">
            {{#if this.preview_image}}
            <div class="post-image">
                <a href="/post/{{this.slug}}">
                    <img src="{{this.preview_image}}" alt="{{this.title}}" loading="lazy">
                </a>
                {{#if (eq this.status 'private')}}
                <div class="private-badge">
                    <i class="fas fa-lock"></i>
                    <span>Private</span>
                </div>
                {{/if}}
                <div class="bookmark-badge" style="display: none;">
                    <i class="fas fa-bookmark"></i>
                    <span>Bookmarked</span>
                </div>
            </div>
            {{/if}}
            <div class="post-meta">
                <div class="post-info">
                    <span class="author">By <a href="/author/{{this.UserName}}">{{this.UserName}}</a></span>
                    <span class="category">in {{#each (split this.categories ', ') as |category|}}
                        <a href="/category/{{encodeURIComponent category}}">{{trim category}}</a>{{#unless @last}},
                        {{/unless}}
                        {{/each}}</span>
                    <span class="date">{{formatDate this.created_at}}</span>
                </div>
            </div>
            <h2 class="post-title">
                <a href="/post/{{this.slug}}">{{this.title}}</a>
            </h2>
            <div class="post-content">
                {{#if this.excerpt}}
                {{truncate (stripMarkdown this.excerpt) 150}}
                {{else}}
                {{truncate (stripMarkdown this.content_markdown) 150}}
                {{/if}}
            </div>
            <div class="post-footer">
                <a href="/post/{{this.slug}}" class="read-more">Read More</a>
                <div class="post-stats">
                    <span class="comments-count"><i class="fas fa-comment"></i> {{this.comment_count}}</span>
                    <span class="views-count"><i class="fas fa-eye"></i> {{this.views}}</span>
                </div>
            </div>
        </article>
        {{/each}}
    </div>

    {{> partial/pagination}}
    {{else}}
    <div class="empty-state">
        <h2>No posts found</h2>
        <p>Be the first to create a post!</p>
        {{#if user}}
        <a href="/dashboard/posts/create" class="btn btn-primary">Create New Post</a>
        {{else}}
        <a href="/mbkauthe/login" class="btn btn-primary">Login to Post</a>
        {{/if}}
    </div>
    {{/if}}
</div>

{{> partial/searchAndFilterScript}}
